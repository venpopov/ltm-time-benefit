---
title: "Linear recovery as a random variable"
format: html
---

## Overview

```{r init}
#| message: false
library(ggplot2)
library(dplyr)
library(targets)
tar_source()
```

Assume that resource recover linearly over time at a constant rate `r` until they reach a maximum value of 1. Assume that `r` is a random variable. Let's plot the average resource recovery over time under different assumptions about the distribution of `r`.

## Assumptions

1. `r` is uniformly distributed between 0 and 1.
2. `r` is distributed as a truncated normal distribution with mean 0.5 and standard deviation 0.3
3. `r` is distributed as an exponential distribution with rate 1

### Uniform distribution

Red line shows the average recovery over time. Black lines show individual trajectories of a few random samples of `r`.

```{r}
set.seed(2)
n <- 1000
r <- runif(n, 0, 1)
t <- seq(0, 5, length.out = 100)

plot_linear_rv_recovery(r, t)
```

### Truncated normal distribution

```{r}
set.seed(2)
n <- 1000
r <- truncnorm::rtruncnorm(n, a = 0, mean = 0.5, sd = 0.3)
t <- seq(0, 5, length.out = 100)

plot_linear_rv_recovery(r, t, title = "Truncated normal distribution")
```

### Exponential distribution

```{r}
set.seed(2)
n <- 1000
r <- rgamma(n, shape = 1, scale = 1)
t <- seq(0, 5, length.out = 100)

plot_linear_rv_recovery(r, t, title = "Exponential distribution")
```
