{
  "hash": "7e8a03bce1eb20c810d4a4cf5907d5df",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Experiment 3\"\nformat: html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(targets)\ntar_source()\ntar_load(c(exp3_data_agg))\ntar_load(fits1)\n\nfits1_e3 <- fits1 |>\n  filter(exp == 3) |>\n  mutate(\n    deviance = pmap_dbl(\n      list(fit, data, exclude_sp1),\n      ~ overall_deviance(params = `..1`$par, data = `..2`, exclude_sp1 = `..3`)\n    ),\n    pred = map2(fit, data, ~ predict(.x, .y, group_by = c(\"chunk\", \"gap\")))\n  )\n```\n:::\n\n\n\n\n## Basic fit\n\nFit starting from the parameters reported in the draft for Experiment 1:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nest <- run_or_load(\n  estimate_model(\n    start = paper_params(),\n    data = exp3_data_agg,\n    two_step = TRUE,\n    exclude_sp1 = TRUE,\n    simplify = TRUE,\n    prior = list(\n      rate = list(mean = 0.05, sd = 0.01)\n    )\n  ),\n  file = \"output/exp3_basic_fit.rds\"\n)\n\nest\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 8\n   prop prop_ltm   rate   tau  gain deviance convergence fit       \n  <dbl>    <dbl>  <dbl> <dbl> <dbl>    <dbl>       <int> <list>    \n1 0.296    0.819 0.0143 0.153  12.9     769.           0 <srl_rcl_>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nexp3_data_agg$pred <- predict(est$fit[[1]], data = exp3_data_agg, group_by = c(\"chunk\", \"gap\"))\n\nexp3_data_agg |>\n  ggplot(aes(gap, p_correct, color = chunk, group = chunk)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", se = FALSE) +\n  geom_line(aes(y = pred), color = \"black\") +\n  scale_color_discrete(\"1st chunk LTM?\") +\n  facet_wrap(~itemtype) +\n  theme_pub()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](exp3_model1_files/figure-html/exp3_performance-1.png){width=816}\n:::\n:::\n\n\n\n\nThese are the best fitting parameters when running with 100 different starting points: \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits1_e3 |>\n  filter(exclude_sp1 == TRUE, priors_scenario == \"none\") |>\n  arrange(deviance) |>\n  select(prop:deviance) |>\n  head(15) |>\n  kableExtra::kable()\n```\n\n::: {.cell-output-display}\n\n\n|      prop|  prop_ltm|      rate|       tau|      gain| deviance|\n|---------:|---------:|---------:|---------:|---------:|--------:|\n| 0.1176852| 0.8038622| 0.0056074| 0.0928974| 69.325675| 764.8021|\n| 0.1171605| 0.8039528| 0.0055792| 0.0925837| 69.905273| 764.8022|\n| 0.1158791| 0.8034533| 0.0055264| 0.0918260| 71.369326| 764.8022|\n| 0.1171228| 0.8034459| 0.0055762| 0.0925632| 69.947438| 764.8023|\n| 0.1223134| 0.8039849| 0.0058120| 0.0955887| 64.418454| 764.8032|\n| 0.1184461| 0.8040876| 0.0056514| 0.0933540| 68.472023| 764.8049|\n| 0.1169663| 0.8037114| 0.0055752| 0.0924832| 70.135163| 764.8066|\n| 0.1255808| 0.8051079| 0.0060152| 0.0974679| 61.297036| 764.8067|\n| 0.1357685| 0.8044079| 0.0064193| 0.1030411| 52.924650| 764.8160|\n| 0.1169577| 0.8037673| 0.0055755| 0.0924814| 70.102525| 764.8164|\n| 0.1516215| 0.8060898| 0.0071830| 0.1111224| 43.004528| 764.8409|\n| 0.5709167| 0.4530002| 0.2213147| 0.2424797|  3.249835| 848.5274|\n| 0.5710025| 0.4530985| 0.2213565| 0.2424506|  3.248783| 848.5274|\n| 0.5711107| 0.4530694| 0.2213929| 0.2424626|  3.247816| 848.5274|\n| 0.5706589| 0.4531750| 0.2211694| 0.2424859|  3.252406| 848.5275|\n\n\n:::\n:::\n\n\n\n\nThe fits require very slow rate again. Here's the plot of the best fitting parameters:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits1_e3 |>\n  filter(exp == 3, exclude_sp1 == TRUE, priors_scenario == \"none\") |>\n  arrange(deviance) |> \n  slice(1) |>\n  select(data, pred) |>\n  unnest(cols = everything()) |>\n  ggplot(aes(gap, p_correct, color = chunk, group = chunk)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", se = FALSE) +\n  geom_line(aes(y = pred), color = \"black\") +\n  scale_color_discrete(\"1st chunk LTM?\") +\n  facet_wrap(~itemtype) +\n  theme_pub()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](exp3_model1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n### Trying priors of the gain parameter\n\nLike for Experiment 1, restrict the gain to be ~ 25\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits1_e3 |>\n  filter(priors_scenario == \"gain\", exclude_sp1 == TRUE, convergence == 0) |>\n  select(prop:convergence) |>\n  arrange(deviance) |>\n  mutate_all(round, 3) |>\n  print(n = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 100 × 7\n    prop prop_ltm  rate   tau  gain deviance convergence\n   <dbl>    <dbl> <dbl> <dbl> <dbl>    <dbl>       <dbl>\n 1 0.204    0.811  0.01 0.132  25.0     765.           0\n 2 0.204    0.81   0.01 0.132  25.0     765.           0\n 3 0.204    0.811  0.01 0.132  25       765.           0\n 4 0.204    0.811  0.01 0.132  25.0     765.           0\n 5 0.204    0.811  0.01 0.132  25       765.           0\n 6 0.204    0.81   0.01 0.132  25       765.           0\n 7 0.204    0.811  0.01 0.132  25.0     765.           0\n 8 0.204    0.811  0.01 0.132  25       765.           0\n 9 0.204    0.81   0.01 0.132  25.0     765.           0\n10 0.204    0.81   0.01 0.132  25.0     765.           0\n# ℹ 90 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\nplot of the best fitting parameters:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits1_e3 |>\n  filter(priors_scenario == \"gain\", exclude_sp1 == TRUE, convergence == 0) |>\n  arrange(deviance) |> \n  slice(1) |>\n  select(data, pred) |>\n  unnest(cols = everything()) |>\n  ggplot(aes(gap, p_correct, color = chunk, group = chunk)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", se = FALSE) +\n  geom_line(aes(y = pred), color = \"black\") +\n  scale_color_discrete(\"1st chunk LTM?\") +\n  facet_wrap(~itemtype) +\n  theme_pub()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](exp3_model1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Trying priors of the rate parameter\n\nLike for Experiment 1, rate parameter prior ~ Normal(0.1, 0.01)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits1_e3 |>\n  filter(priors_scenario == \"rate\", exclude_sp1 == TRUE, convergence == 0) |>\n  select(prop:convergence) |>\n  arrange(deviance) |>\n  mutate_all(round, 3) |>\n  print(n = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 98 × 7\n    prop prop_ltm  rate   tau  gain deviance convergence\n   <dbl>    <dbl> <dbl> <dbl> <dbl>    <dbl>       <dbl>\n 1 0.404    0.831 0.021 0.153  7.74     770.           0\n 2 0.407    0.832 0.021 0.152  7.65     770.           0\n 3 0.408    0.832 0.021 0.152  7.63     770.           0\n 4 0.408    0.832 0.021 0.152  7.64     770.           0\n 5 0.408    0.832 0.021 0.152  7.62     770.           0\n 6 0.408    0.832 0.021 0.152  7.62     770.           0\n 7 0.408    0.832 0.021 0.152  7.62     770.           0\n 8 0.408    0.832 0.021 0.152  7.62     770.           0\n 9 0.408    0.832 0.021 0.152  7.62     770.           0\n10 0.409    0.832 0.021 0.152  7.61     770.           0\n# ℹ 88 more rows\n```\n\n\n:::\n:::\n\n\n\n\nplot of the best fitting parameters:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits1_e3 |>\n  filter(priors_scenario == \"rate\", exclude_sp1 == TRUE, convergence == 0) |>\n  arrange(deviance) |> \n  slice(1) |>\n  select(data, pred) |>\n  unnest(cols = everything()) |>\n  ggplot(aes(gap, p_correct, color = chunk, group = chunk)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", se = FALSE) +\n  geom_line(aes(y = pred), color = \"black\") +\n  scale_color_discrete(\"1st chunk LTM?\") +\n  facet_wrap(~itemtype) +\n  theme_pub()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](exp3_model1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n## Summary\n\nThe linear recovery model cannot fit the interaction present in the data. As discussed elsewhere, this is because in order to capture the primacy effect and the global proactive benefit of free time, it needs low depletion and low recovery rates.\n",
    "supporting": [
      "exp3_model1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}