{
  "hash": "18b4027b0db714a1425b3ba8db5053a7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Parameter identifiability\"\nformat: \n  html:\n    html-table-processing: none\n---\n\n\n## Overview\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(targets)\nlibrary(GGally)\nlibrary(kableExtra)\ntar_source()\n```\n:::\n\n\nIn [the initial modeling notebook](modelling_edas_approach.qmd#problem-with-parameter-identifiability), I discovered some problems with parameter identifiability. Here I will explore this issue further.\n\nInitially I ran the model described in the May 13, 2024 draft with 100 different starting parameters. Here are 5 sets of very different best-fitting parameters that produce nearly identical fits as measured by the negative log-likelihood (deviance):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits <- readRDS(\"output/five_parsets_exp2.rds\")\nfits$set <- paste0(\"set\", 1:5)\n\nfits[, 1:6] |>\n  as.data.frame() |>\n  `rownames<-`(fits$set) |>\n  kbl() %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> prop </th>\n   <th style=\"text-align:right;\"> prop_ltm </th>\n   <th style=\"text-align:right;\"> rate </th>\n   <th style=\"text-align:right;\"> tau </th>\n   <th style=\"text-align:right;\"> gain </th>\n   <th style=\"text-align:right;\"> deviance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> set1 </td>\n   <td style=\"text-align:right;\"> 0.098 </td>\n   <td style=\"text-align:right;\"> 0.815 </td>\n   <td style=\"text-align:right;\"> 0.006 </td>\n   <td style=\"text-align:right;\"> 0.084 </td>\n   <td style=\"text-align:right;\"> 96.954 </td>\n   <td style=\"text-align:right;\"> 40.377 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> set2 </td>\n   <td style=\"text-align:right;\"> 0.132 </td>\n   <td style=\"text-align:right;\"> 0.818 </td>\n   <td style=\"text-align:right;\"> 0.009 </td>\n   <td style=\"text-align:right;\"> 0.108 </td>\n   <td style=\"text-align:right;\"> 54.078 </td>\n   <td style=\"text-align:right;\"> 40.429 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> set3 </td>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.820 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.123 </td>\n   <td style=\"text-align:right;\"> 40.135 </td>\n   <td style=\"text-align:right;\"> 40.491 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> set4 </td>\n   <td style=\"text-align:right;\"> 0.173 </td>\n   <td style=\"text-align:right;\"> 0.822 </td>\n   <td style=\"text-align:right;\"> 0.011 </td>\n   <td style=\"text-align:right;\"> 0.133 </td>\n   <td style=\"text-align:right;\"> 32.738 </td>\n   <td style=\"text-align:right;\"> 40.556 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> set5 </td>\n   <td style=\"text-align:right;\"> 0.215 </td>\n   <td style=\"text-align:right;\"> 0.826 </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 21.967 </td>\n   <td style=\"text-align:right;\"> 40.772 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe can see that they all produce nearly identical predictions (the lines are the model predictions, the points are the data):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits |>\n  mutate(pred = map2(fit, data, \\(x, y) predict(x, y, group_by = c(\"chunk\", \"gap\")))) |>\n  unnest(c(data, pred)) |>\n  mutate(gap = as.factor(gap)) |>\n  ggplot(aes(x = gap, y = p_correct, color = chunk)) +\n  geom_point() +\n  geom_line(aes(y = pred, linetype = set, group = interaction(chunk, set))) +\n  scale_color_discrete(\"First chunk LTM?\") +\n  scale_linetype_discrete(\"Parameter set\") +\n  facet_grid(~itemtype) +\n  theme_pub()\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot five fits-1.png){width=816}\n:::\n:::\n\n\nThe plot below shows the strong nearly linear trade-offs between the parameters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfits |>\n  select(prop, rate, tau, gain) |>\n  ggpairs(\n    diag = list(continuous = \"blankDiag\"),\n    upper = list(continuous = \"points\")\n  ) +\n  theme_pub() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot par correlations-1.png){width=816}\n:::\n:::\n\n\n## Fix rate to different values and explore the parameter space\n\nI ran a simulation in which I fix[^1] the rate parameter to values in the range 0.005 to 0.2. I want to see if the identical fits extend to higher rates.\n\n[^1]: technically, I put a really narrow prior Normal(value, 0.0001) on the rate parameter rather than fixing it just because I can do it in the existing code.\n\nWe first extract the best-fitting parameters for each rate from the 100 random start fits.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntar_load(fits2)\nfits2 <- fits2 |>\n  mutate(\n    deviance = pmap_dbl(list(fit, data, exclude_sp1), function(x, y, z) {\n      overall_deviance(x$par, data = y, exclude_sp1 = z)\n    }),\n    rate = round(rate, 3)\n  )\n\n\nbest <- fits2 |>\n  group_by(rate, exp, exclude_sp1) |>\n  filter(deviance == min(deviance)) |>\n  slice(1) |>\n  select(rate, prop, prop_ltm, tau, gain, deviance, fit, data) |>\n  mutate(pred = map2(fit, data, \\(x, y) predict(x, y, group_by = c(\"chunk\", \"gap\")))) |>\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nAdding missing grouping variables: `exp`, `exclude_sp1`\n```\n\n\n:::\n:::\n\n\nsubset for exp2 and exclude_sp1 = TRUE\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_subset <- filter(best, exp == 2, exclude_sp1)\n```\n:::\n\n\nFrom the deviance it's already clear that the fits get wose once we get above 0.020 rate. Here are the best-fitting parameters for each rate:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_subset |>\n  select(rate, prop, prop_ltm, tau, gain, deviance) |>\n  mutate_all(round, 3) |>\n  kbl() %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> rate </th>\n   <th style=\"text-align:right;\"> prop </th>\n   <th style=\"text-align:right;\"> prop_ltm </th>\n   <th style=\"text-align:right;\"> tau </th>\n   <th style=\"text-align:right;\"> gain </th>\n   <th style=\"text-align:right;\"> deviance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 0.807 </td>\n   <td style=\"text-align:right;\"> 0.083 </td>\n   <td style=\"text-align:right;\"> 99.999 </td>\n   <td style=\"text-align:right;\"> 41.918 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.156 </td>\n   <td style=\"text-align:right;\"> 0.820 </td>\n   <td style=\"text-align:right;\"> 0.123 </td>\n   <td style=\"text-align:right;\"> 39.914 </td>\n   <td style=\"text-align:right;\"> 40.494 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.236 </td>\n   <td style=\"text-align:right;\"> 0.827 </td>\n   <td style=\"text-align:right;\"> 0.163 </td>\n   <td style=\"text-align:right;\"> 18.516 </td>\n   <td style=\"text-align:right;\"> 40.936 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.020 </td>\n   <td style=\"text-align:right;\"> 0.317 </td>\n   <td style=\"text-align:right;\"> 0.835 </td>\n   <td style=\"text-align:right;\"> 0.189 </td>\n   <td style=\"text-align:right;\"> 11.043 </td>\n   <td style=\"text-align:right;\"> 41.839 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.025 </td>\n   <td style=\"text-align:right;\"> 0.392 </td>\n   <td style=\"text-align:right;\"> 0.841 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> 7.750 </td>\n   <td style=\"text-align:right;\"> 43.424 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.030 </td>\n   <td style=\"text-align:right;\"> 0.452 </td>\n   <td style=\"text-align:right;\"> 0.845 </td>\n   <td style=\"text-align:right;\"> 0.206 </td>\n   <td style=\"text-align:right;\"> 6.102 </td>\n   <td style=\"text-align:right;\"> 45.917 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 0.497 </td>\n   <td style=\"text-align:right;\"> 0.845 </td>\n   <td style=\"text-align:right;\"> 0.207 </td>\n   <td style=\"text-align:right;\"> 5.176 </td>\n   <td style=\"text-align:right;\"> 49.404 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.040 </td>\n   <td style=\"text-align:right;\"> 0.531 </td>\n   <td style=\"text-align:right;\"> 0.835 </td>\n   <td style=\"text-align:right;\"> 0.208 </td>\n   <td style=\"text-align:right;\"> 4.547 </td>\n   <td style=\"text-align:right;\"> 53.751 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.323 </td>\n   <td style=\"text-align:right;\"> 0.460 </td>\n   <td style=\"text-align:right;\"> 0.216 </td>\n   <td style=\"text-align:right;\"> 8.453 </td>\n   <td style=\"text-align:right;\"> 57.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.353 </td>\n   <td style=\"text-align:right;\"> 0.455 </td>\n   <td style=\"text-align:right;\"> 0.227 </td>\n   <td style=\"text-align:right;\"> 7.126 </td>\n   <td style=\"text-align:right;\"> 58.293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.383 </td>\n   <td style=\"text-align:right;\"> 0.451 </td>\n   <td style=\"text-align:right;\"> 0.237 </td>\n   <td style=\"text-align:right;\"> 6.124 </td>\n   <td style=\"text-align:right;\"> 59.201 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.060 </td>\n   <td style=\"text-align:right;\"> 0.411 </td>\n   <td style=\"text-align:right;\"> 0.445 </td>\n   <td style=\"text-align:right;\"> 0.245 </td>\n   <td style=\"text-align:right;\"> 5.379 </td>\n   <td style=\"text-align:right;\"> 60.241 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.065 </td>\n   <td style=\"text-align:right;\"> 0.438 </td>\n   <td style=\"text-align:right;\"> 0.441 </td>\n   <td style=\"text-align:right;\"> 0.251 </td>\n   <td style=\"text-align:right;\"> 4.770 </td>\n   <td style=\"text-align:right;\"> 61.411 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.449 </td>\n   <td style=\"text-align:right;\"> 0.194 </td>\n   <td style=\"text-align:right;\"> 13.515 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.075 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.456 </td>\n   <td style=\"text-align:right;\"> 0.195 </td>\n   <td style=\"text-align:right;\"> 13.725 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.196 </td>\n   <td style=\"text-align:right;\"> 13.863 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.085 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.468 </td>\n   <td style=\"text-align:right;\"> 0.196 </td>\n   <td style=\"text-align:right;\"> 14.045 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.090 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.474 </td>\n   <td style=\"text-align:right;\"> 0.197 </td>\n   <td style=\"text-align:right;\"> 14.177 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.095 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.481 </td>\n   <td style=\"text-align:right;\"> 0.198 </td>\n   <td style=\"text-align:right;\"> 14.333 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.100 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.487 </td>\n   <td style=\"text-align:right;\"> 0.198 </td>\n   <td style=\"text-align:right;\"> 14.595 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.105 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.493 </td>\n   <td style=\"text-align:right;\"> 0.199 </td>\n   <td style=\"text-align:right;\"> 14.713 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.110 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.500 </td>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 14.911 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.506 </td>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 15.071 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.120 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.512 </td>\n   <td style=\"text-align:right;\"> 0.201 </td>\n   <td style=\"text-align:right;\"> 15.259 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.125 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.519 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> 15.519 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.130 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.525 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> 15.684 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.135 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.531 </td>\n   <td style=\"text-align:right;\"> 0.203 </td>\n   <td style=\"text-align:right;\"> 15.947 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.140 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.537 </td>\n   <td style=\"text-align:right;\"> 0.204 </td>\n   <td style=\"text-align:right;\"> 16.128 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.543 </td>\n   <td style=\"text-align:right;\"> 0.205 </td>\n   <td style=\"text-align:right;\"> 16.266 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.550 </td>\n   <td style=\"text-align:right;\"> 0.205 </td>\n   <td style=\"text-align:right;\"> 16.551 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.556 </td>\n   <td style=\"text-align:right;\"> 0.206 </td>\n   <td style=\"text-align:right;\"> 16.745 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.160 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.563 </td>\n   <td style=\"text-align:right;\"> 0.206 </td>\n   <td style=\"text-align:right;\"> 17.087 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.165 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.569 </td>\n   <td style=\"text-align:right;\"> 0.207 </td>\n   <td style=\"text-align:right;\"> 17.348 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.170 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.574 </td>\n   <td style=\"text-align:right;\"> 0.208 </td>\n   <td style=\"text-align:right;\"> 17.449 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.175 </td>\n   <td style=\"text-align:right;\"> 0.254 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.209 </td>\n   <td style=\"text-align:right;\"> 17.835 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.180 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.587 </td>\n   <td style=\"text-align:right;\"> 0.209 </td>\n   <td style=\"text-align:right;\"> 18.074 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.185 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n   <td style=\"text-align:right;\"> 0.210 </td>\n   <td style=\"text-align:right;\"> 18.315 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.190 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.600 </td>\n   <td style=\"text-align:right;\"> 0.211 </td>\n   <td style=\"text-align:right;\"> 18.573 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.195 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.606 </td>\n   <td style=\"text-align:right;\"> 0.211 </td>\n   <td style=\"text-align:right;\"> 18.940 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 0.255 </td>\n   <td style=\"text-align:right;\"> 0.612 </td>\n   <td style=\"text-align:right;\"> 0.212 </td>\n   <td style=\"text-align:right;\"> 19.209 </td>\n   <td style=\"text-align:right;\"> 62.522 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nA few observations:\n\n1) with recovery rates higher than 0.07 the fits do no change much\n2) when the rate changes from 0.04 to 0.045, we switch to a different region of the parameter space. Similarly from 0.065 to 0.07\n3) looks like we have four ranges of rates with qualitative shifts:\n     - ***0.005 to 0.02:*** the fits are very similar and prop_ltm is ~ 0.8. The other parameters change proportionally to the rate\n     - ***0.025 to 0.04:*** fits get progressively worse. the other parameters still changes similarly to the first group, but tau is not stable. Seems like tau can no longer compensate, leading to worsening fits\n     - ***0.045 to 0.07:*** prop_ltm drops to ~0.45 and stays there. The other parameters again change proportionally to the rate, but they are now in a different region of the parameter space. Fits gradually worsen as we increase the rates\n     - ***0.07 to 0.2:*** prop is now stable at ~0.255. The other parameters change but with very small increments. Fits are identical\n\nHere's a pairs plot with colors indicating the rate group. The plot indicates that the parameter space does not have a smooth gradient, but rather jumps between regions when rate is fixed to different values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_subset <- best_subset |>\n  mutate(par_groups = case_when(\n    rate <= 0.02 ~ \"0.005-0.02\",\n    rate <= 0.04 ~ \"0.025-0.04\",\n    rate <= 0.07 ~ \"0.045-0.07\",\n    TRUE ~ \"0.07-0.2\"\n  ))\n\nbest_subset |>\n  select(prop, prop_ltm, rate, tau, gain, par_groups) |>\n  ggpairs(\n    aes(color = par_groups),\n    diag = list(continuous = \"blankDiag\"),\n    upper = list(continuous = \"points\")\n  ) +\n  theme_pub() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate correlations-1.png){width=816}\n:::\n:::\n\n\nLet's see how this affects the predictions for the different rate groups. It would be too much to plot all the predictions, so I will first plot the predictions for the first and last parameters for each rate group.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_subset |>\n  group_by(par_groups) |>\n  slice(c(1, n())) |>\n  unnest(c(data, pred)) |>\n  mutate(\n    gap = as.factor(gap),\n    rate = as.factor(round(rate, 3))\n  ) |>\n  ggplot(aes(x = gap, y = p_correct, color = chunk)) +\n  geom_point() +\n  geom_line(aes(y = pred, linetype = par_groups, group = interaction(chunk, rate))) +\n  scale_color_discrete(\"First chunk LTM?\") +\n  scale_linetype_discrete(\"Rate\") +\n  facet_grid(rate ~ itemtype) +\n  theme_pub()\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits-1.png){width=816}\n:::\n:::\n\n\nA few observations:\n\n- Rates above 0.045 lead to the same fit, because they cause full recovery from first item to the second with 6 s ISI. We can see that from he plots because the prediction for SP1-3 and sp4-6 (6000 ISI) are the same for all rates above 0.045, meaning no serial position effect from the first to the second chunk. This is completely implausible, so we can rule out rates above 0.045.\n\n### Including SP1-3 in the fits\n\nI will now include SP1-3 in the fits and see if this changes the parameter space.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_subset <- filter(best, exp == 2, exclude_sp1 == FALSE)\n```\n:::\n\n\nHere are the best-fitting parameters for each rate:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_subset |>\n  select(rate, prop, prop_ltm, tau, gain, deviance) |>\n  mutate_all(round, 3) |>\n  kbl() %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> rate </th>\n   <th style=\"text-align:right;\"> prop </th>\n   <th style=\"text-align:right;\"> prop_ltm </th>\n   <th style=\"text-align:right;\"> tau </th>\n   <th style=\"text-align:right;\"> gain </th>\n   <th style=\"text-align:right;\"> deviance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.103 </td>\n   <td style=\"text-align:right;\"> 0.869 </td>\n   <td style=\"text-align:right;\"> 0.088 </td>\n   <td style=\"text-align:right;\"> 97.961 </td>\n   <td style=\"text-align:right;\"> 109.674 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.204 </td>\n   <td style=\"text-align:right;\"> 0.864 </td>\n   <td style=\"text-align:right;\"> 0.146 </td>\n   <td style=\"text-align:right;\"> 26.281 </td>\n   <td style=\"text-align:right;\"> 105.652 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.288 </td>\n   <td style=\"text-align:right;\"> 0.857 </td>\n   <td style=\"text-align:right;\"> 0.178 </td>\n   <td style=\"text-align:right;\"> 13.917 </td>\n   <td style=\"text-align:right;\"> 103.465 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.020 </td>\n   <td style=\"text-align:right;\"> 0.357 </td>\n   <td style=\"text-align:right;\"> 0.856 </td>\n   <td style=\"text-align:right;\"> 0.194 </td>\n   <td style=\"text-align:right;\"> 9.432 </td>\n   <td style=\"text-align:right;\"> 103.037 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.025 </td>\n   <td style=\"text-align:right;\"> 0.416 </td>\n   <td style=\"text-align:right;\"> 0.854 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> 7.196 </td>\n   <td style=\"text-align:right;\"> 104.119 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.030 </td>\n   <td style=\"text-align:right;\"> 0.468 </td>\n   <td style=\"text-align:right;\"> 0.851 </td>\n   <td style=\"text-align:right;\"> 0.205 </td>\n   <td style=\"text-align:right;\"> 5.864 </td>\n   <td style=\"text-align:right;\"> 106.495 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 0.513 </td>\n   <td style=\"text-align:right;\"> 0.850 </td>\n   <td style=\"text-align:right;\"> 0.205 </td>\n   <td style=\"text-align:right;\"> 5.023 </td>\n   <td style=\"text-align:right;\"> 110.006 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.040 </td>\n   <td style=\"text-align:right;\"> 0.553 </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n   <td style=\"text-align:right;\"> 0.204 </td>\n   <td style=\"text-align:right;\"> 4.417 </td>\n   <td style=\"text-align:right;\"> 114.529 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.590 </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n   <td style=\"text-align:right;\"> 0.201 </td>\n   <td style=\"text-align:right;\"> 3.950 </td>\n   <td style=\"text-align:right;\"> 119.980 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.624 </td>\n   <td style=\"text-align:right;\"> 0.850 </td>\n   <td style=\"text-align:right;\"> 0.197 </td>\n   <td style=\"text-align:right;\"> 3.596 </td>\n   <td style=\"text-align:right;\"> 126.280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.654 </td>\n   <td style=\"text-align:right;\"> 0.848 </td>\n   <td style=\"text-align:right;\"> 0.194 </td>\n   <td style=\"text-align:right;\"> 3.325 </td>\n   <td style=\"text-align:right;\"> 133.345 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.060 </td>\n   <td style=\"text-align:right;\"> 0.684 </td>\n   <td style=\"text-align:right;\"> 0.847 </td>\n   <td style=\"text-align:right;\"> 0.190 </td>\n   <td style=\"text-align:right;\"> 3.079 </td>\n   <td style=\"text-align:right;\"> 141.200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.065 </td>\n   <td style=\"text-align:right;\"> 0.715 </td>\n   <td style=\"text-align:right;\"> 0.848 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n   <td style=\"text-align:right;\"> 2.853 </td>\n   <td style=\"text-align:right;\"> 149.735 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> 0.741 </td>\n   <td style=\"text-align:right;\"> 0.846 </td>\n   <td style=\"text-align:right;\"> 0.179 </td>\n   <td style=\"text-align:right;\"> 2.681 </td>\n   <td style=\"text-align:right;\"> 158.918 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.075 </td>\n   <td style=\"text-align:right;\"> 0.764 </td>\n   <td style=\"text-align:right;\"> 0.850 </td>\n   <td style=\"text-align:right;\"> 0.174 </td>\n   <td style=\"text-align:right;\"> 2.538 </td>\n   <td style=\"text-align:right;\"> 168.744 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.788 </td>\n   <td style=\"text-align:right;\"> 0.847 </td>\n   <td style=\"text-align:right;\"> 0.169 </td>\n   <td style=\"text-align:right;\"> 2.403 </td>\n   <td style=\"text-align:right;\"> 179.141 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.085 </td>\n   <td style=\"text-align:right;\"> 0.809 </td>\n   <td style=\"text-align:right;\"> 0.846 </td>\n   <td style=\"text-align:right;\"> 0.165 </td>\n   <td style=\"text-align:right;\"> 2.291 </td>\n   <td style=\"text-align:right;\"> 190.074 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.090 </td>\n   <td style=\"text-align:right;\"> 0.831 </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n   <td style=\"text-align:right;\"> 0.158 </td>\n   <td style=\"text-align:right;\"> 2.174 </td>\n   <td style=\"text-align:right;\"> 201.568 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.095 </td>\n   <td style=\"text-align:right;\"> 0.850 </td>\n   <td style=\"text-align:right;\"> 0.849 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 2.088 </td>\n   <td style=\"text-align:right;\"> 213.548 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.100 </td>\n   <td style=\"text-align:right;\"> 0.868 </td>\n   <td style=\"text-align:right;\"> 0.852 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 1.999 </td>\n   <td style=\"text-align:right;\"> 225.953 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.105 </td>\n   <td style=\"text-align:right;\"> 0.790 </td>\n   <td style=\"text-align:right;\"> 0.590 </td>\n   <td style=\"text-align:right;\"> 0.212 </td>\n   <td style=\"text-align:right;\"> 2.315 </td>\n   <td style=\"text-align:right;\"> 237.939 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.110 </td>\n   <td style=\"text-align:right;\"> 0.808 </td>\n   <td style=\"text-align:right;\"> 0.587 </td>\n   <td style=\"text-align:right;\"> 0.208 </td>\n   <td style=\"text-align:right;\"> 2.220 </td>\n   <td style=\"text-align:right;\"> 243.828 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.826 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.204 </td>\n   <td style=\"text-align:right;\"> 2.134 </td>\n   <td style=\"text-align:right;\"> 250.034 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.120 </td>\n   <td style=\"text-align:right;\"> 0.844 </td>\n   <td style=\"text-align:right;\"> 0.579 </td>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 2.055 </td>\n   <td style=\"text-align:right;\"> 256.562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.125 </td>\n   <td style=\"text-align:right;\"> 0.862 </td>\n   <td style=\"text-align:right;\"> 0.579 </td>\n   <td style=\"text-align:right;\"> 0.195 </td>\n   <td style=\"text-align:right;\"> 1.974 </td>\n   <td style=\"text-align:right;\"> 263.374 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.130 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.607 </td>\n   <td style=\"text-align:right;\"> 0.268 </td>\n   <td style=\"text-align:right;\"> 4.444 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.135 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.609 </td>\n   <td style=\"text-align:right;\"> 0.269 </td>\n   <td style=\"text-align:right;\"> 4.464 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.140 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.611 </td>\n   <td style=\"text-align:right;\"> 0.270 </td>\n   <td style=\"text-align:right;\"> 4.489 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.613 </td>\n   <td style=\"text-align:right;\"> 0.272 </td>\n   <td style=\"text-align:right;\"> 4.509 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.615 </td>\n   <td style=\"text-align:right;\"> 0.273 </td>\n   <td style=\"text-align:right;\"> 4.535 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.617 </td>\n   <td style=\"text-align:right;\"> 0.275 </td>\n   <td style=\"text-align:right;\"> 4.559 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.160 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.619 </td>\n   <td style=\"text-align:right;\"> 0.276 </td>\n   <td style=\"text-align:right;\"> 4.584 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.165 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.621 </td>\n   <td style=\"text-align:right;\"> 0.278 </td>\n   <td style=\"text-align:right;\"> 4.609 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.170 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.623 </td>\n   <td style=\"text-align:right;\"> 0.279 </td>\n   <td style=\"text-align:right;\"> 4.631 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.175 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.625 </td>\n   <td style=\"text-align:right;\"> 0.281 </td>\n   <td style=\"text-align:right;\"> 4.656 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.180 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n   <td style=\"text-align:right;\"> 0.282 </td>\n   <td style=\"text-align:right;\"> 4.683 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.185 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.629 </td>\n   <td style=\"text-align:right;\"> 0.284 </td>\n   <td style=\"text-align:right;\"> 4.707 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.190 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.631 </td>\n   <td style=\"text-align:right;\"> 0.285 </td>\n   <td style=\"text-align:right;\"> 4.732 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.195 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.633 </td>\n   <td style=\"text-align:right;\"> 0.287 </td>\n   <td style=\"text-align:right;\"> 4.761 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 0.552 </td>\n   <td style=\"text-align:right;\"> 0.635 </td>\n   <td style=\"text-align:right;\"> 0.288 </td>\n   <td style=\"text-align:right;\"> 4.787 </td>\n   <td style=\"text-align:right;\"> 267.044 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThis now looks much more stable. Until 0.130 we don't have switchest in the parameter region. Still, rates 0.005-0.03 are very similar.\n\nHere are the plots for rates 0.005-0.10:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_data <- best_subset |>\n  unnest(c(data, pred)) |>\n  mutate(\n    gap = as.factor(gap),\n    rate = round(rate, 3)\n  )\n\nmyplot <- function(data) {\n  ggplot(data, aes(x = gap, y = p_correct, color = chunk)) +\n    geom_point() +\n    geom_line(aes(y = pred, group = chunk)) +\n    scale_color_discrete(\"First chunk LTM?\") +\n    facet_grid(rate ~ itemtype) +\n    theme_pub()\n}\n```\n:::\n\n\n::: {.panel-tabset}\n\n## Rate [0.005, 0.025]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate < 0.026))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits sp1 1-1.png){width=768}\n:::\n:::\n\n\n## Rate [0.03, 0.05]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate < 0.051 & rate > 0.029))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits sp1 2-1.png){width=768}\n:::\n:::\n\n\n## Rate [0.055, 0.75]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate < 0.076 & rate > 0.054))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits sp1 3-1.png){width=768}\n:::\n:::\n\n\n## Rate [0.08, 0.10]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate > 0.079, rate < 0.101))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits sp1 4-1.png){width=768}\n:::\n:::\n\n\n:::\n\n## What about experiment 1?\n\nI will now repeat the same analysis for experiment 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_subset <- filter(best, exp == 1, exclude_sp1)\n\nbest_subset |>\n  select(rate, prop, prop_ltm, tau, gain, deviance) |>\n  mutate_all(round, 3) |>\n  kbl() %>%\n  kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> rate </th>\n   <th style=\"text-align:right;\"> prop </th>\n   <th style=\"text-align:right;\"> prop_ltm </th>\n   <th style=\"text-align:right;\"> tau </th>\n   <th style=\"text-align:right;\"> gain </th>\n   <th style=\"text-align:right;\"> deviance </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.106 </td>\n   <td style=\"text-align:right;\"> 0.571 </td>\n   <td style=\"text-align:right;\"> 0.089 </td>\n   <td style=\"text-align:right;\"> 99.999 </td>\n   <td style=\"text-align:right;\"> 36.361 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.576 </td>\n   <td style=\"text-align:right;\"> 0.096 </td>\n   <td style=\"text-align:right;\"> 85.598 </td>\n   <td style=\"text-align:right;\"> 31.959 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.015 </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n   <td style=\"text-align:right;\"> 0.581 </td>\n   <td style=\"text-align:right;\"> 0.130 </td>\n   <td style=\"text-align:right;\"> 40.512 </td>\n   <td style=\"text-align:right;\"> 32.380 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.020 </td>\n   <td style=\"text-align:right;\"> 0.222 </td>\n   <td style=\"text-align:right;\"> 0.587 </td>\n   <td style=\"text-align:right;\"> 0.154 </td>\n   <td style=\"text-align:right;\"> 24.850 </td>\n   <td style=\"text-align:right;\"> 33.079 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.025 </td>\n   <td style=\"text-align:right;\"> 0.272 </td>\n   <td style=\"text-align:right;\"> 0.594 </td>\n   <td style=\"text-align:right;\"> 0.172 </td>\n   <td style=\"text-align:right;\"> 17.347 </td>\n   <td style=\"text-align:right;\"> 34.077 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.030 </td>\n   <td style=\"text-align:right;\"> 0.313 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n   <td style=\"text-align:right;\"> 0.184 </td>\n   <td style=\"text-align:right;\"> 13.478 </td>\n   <td style=\"text-align:right;\"> 35.385 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.035 </td>\n   <td style=\"text-align:right;\"> 0.349 </td>\n   <td style=\"text-align:right;\"> 0.602 </td>\n   <td style=\"text-align:right;\"> 0.191 </td>\n   <td style=\"text-align:right;\"> 11.101 </td>\n   <td style=\"text-align:right;\"> 37.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.040 </td>\n   <td style=\"text-align:right;\"> 0.385 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.196 </td>\n   <td style=\"text-align:right;\"> 9.406 </td>\n   <td style=\"text-align:right;\"> 38.915 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.045 </td>\n   <td style=\"text-align:right;\"> 0.413 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 8.302 </td>\n   <td style=\"text-align:right;\"> 41.117 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 0.439 </td>\n   <td style=\"text-align:right;\"> 0.606 </td>\n   <td style=\"text-align:right;\"> 0.202 </td>\n   <td style=\"text-align:right;\"> 7.434 </td>\n   <td style=\"text-align:right;\"> 43.577 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.055 </td>\n   <td style=\"text-align:right;\"> 0.462 </td>\n   <td style=\"text-align:right;\"> 0.606 </td>\n   <td style=\"text-align:right;\"> 0.203 </td>\n   <td style=\"text-align:right;\"> 6.807 </td>\n   <td style=\"text-align:right;\"> 46.273 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.060 </td>\n   <td style=\"text-align:right;\"> 0.480 </td>\n   <td style=\"text-align:right;\"> 0.602 </td>\n   <td style=\"text-align:right;\"> 0.205 </td>\n   <td style=\"text-align:right;\"> 6.313 </td>\n   <td style=\"text-align:right;\"> 49.172 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.065 </td>\n   <td style=\"text-align:right;\"> 0.498 </td>\n   <td style=\"text-align:right;\"> 0.598 </td>\n   <td style=\"text-align:right;\"> 0.206 </td>\n   <td style=\"text-align:right;\"> 5.885 </td>\n   <td style=\"text-align:right;\"> 52.252 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> 0.512 </td>\n   <td style=\"text-align:right;\"> 0.593 </td>\n   <td style=\"text-align:right;\"> 0.207 </td>\n   <td style=\"text-align:right;\"> 5.538 </td>\n   <td style=\"text-align:right;\"> 55.470 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.075 </td>\n   <td style=\"text-align:right;\"> 0.405 </td>\n   <td style=\"text-align:right;\"> 0.373 </td>\n   <td style=\"text-align:right;\"> 0.221 </td>\n   <td style=\"text-align:right;\"> 7.355 </td>\n   <td style=\"text-align:right;\"> 56.968 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.424 </td>\n   <td style=\"text-align:right;\"> 0.370 </td>\n   <td style=\"text-align:right;\"> 0.225 </td>\n   <td style=\"text-align:right;\"> 6.788 </td>\n   <td style=\"text-align:right;\"> 58.529 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.085 </td>\n   <td style=\"text-align:right;\"> 0.441 </td>\n   <td style=\"text-align:right;\"> 0.368 </td>\n   <td style=\"text-align:right;\"> 0.228 </td>\n   <td style=\"text-align:right;\"> 6.317 </td>\n   <td style=\"text-align:right;\"> 60.170 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.090 </td>\n   <td style=\"text-align:right;\"> 0.458 </td>\n   <td style=\"text-align:right;\"> 0.363 </td>\n   <td style=\"text-align:right;\"> 0.230 </td>\n   <td style=\"text-align:right;\"> 5.895 </td>\n   <td style=\"text-align:right;\"> 61.889 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.095 </td>\n   <td style=\"text-align:right;\"> 0.475 </td>\n   <td style=\"text-align:right;\"> 0.359 </td>\n   <td style=\"text-align:right;\"> 0.232 </td>\n   <td style=\"text-align:right;\"> 5.526 </td>\n   <td style=\"text-align:right;\"> 63.680 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.100 </td>\n   <td style=\"text-align:right;\"> 0.489 </td>\n   <td style=\"text-align:right;\"> 0.357 </td>\n   <td style=\"text-align:right;\"> 0.233 </td>\n   <td style=\"text-align:right;\"> 5.226 </td>\n   <td style=\"text-align:right;\"> 65.540 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.105 </td>\n   <td style=\"text-align:right;\"> 0.505 </td>\n   <td style=\"text-align:right;\"> 0.353 </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 4.935 </td>\n   <td style=\"text-align:right;\"> 67.464 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.110 </td>\n   <td style=\"text-align:right;\"> 0.519 </td>\n   <td style=\"text-align:right;\"> 0.350 </td>\n   <td style=\"text-align:right;\"> 0.236 </td>\n   <td style=\"text-align:right;\"> 4.685 </td>\n   <td style=\"text-align:right;\"> 69.449 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.533 </td>\n   <td style=\"text-align:right;\"> 0.346 </td>\n   <td style=\"text-align:right;\"> 0.237 </td>\n   <td style=\"text-align:right;\"> 4.461 </td>\n   <td style=\"text-align:right;\"> 71.487 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.120 </td>\n   <td style=\"text-align:right;\"> 0.546 </td>\n   <td style=\"text-align:right;\"> 0.342 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 4.272 </td>\n   <td style=\"text-align:right;\"> 73.572 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.125 </td>\n   <td style=\"text-align:right;\"> 0.561 </td>\n   <td style=\"text-align:right;\"> 0.337 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 4.062 </td>\n   <td style=\"text-align:right;\"> 75.711 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.130 </td>\n   <td style=\"text-align:right;\"> 0.573 </td>\n   <td style=\"text-align:right;\"> 0.334 </td>\n   <td style=\"text-align:right;\"> 0.239 </td>\n   <td style=\"text-align:right;\"> 3.902 </td>\n   <td style=\"text-align:right;\"> 77.890 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.135 </td>\n   <td style=\"text-align:right;\"> 0.585 </td>\n   <td style=\"text-align:right;\"> 0.332 </td>\n   <td style=\"text-align:right;\"> 0.239 </td>\n   <td style=\"text-align:right;\"> 3.754 </td>\n   <td style=\"text-align:right;\"> 80.108 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.140 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n   <td style=\"text-align:right;\"> 0.327 </td>\n   <td style=\"text-align:right;\"> 0.239 </td>\n   <td style=\"text-align:right;\"> 3.609 </td>\n   <td style=\"text-align:right;\"> 82.362 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.145 </td>\n   <td style=\"text-align:right;\"> 0.608 </td>\n   <td style=\"text-align:right;\"> 0.322 </td>\n   <td style=\"text-align:right;\"> 0.239 </td>\n   <td style=\"text-align:right;\"> 3.475 </td>\n   <td style=\"text-align:right;\"> 84.648 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.150 </td>\n   <td style=\"text-align:right;\"> 0.619 </td>\n   <td style=\"text-align:right;\"> 0.317 </td>\n   <td style=\"text-align:right;\"> 0.239 </td>\n   <td style=\"text-align:right;\"> 3.354 </td>\n   <td style=\"text-align:right;\"> 86.964 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.155 </td>\n   <td style=\"text-align:right;\"> 0.631 </td>\n   <td style=\"text-align:right;\"> 0.316 </td>\n   <td style=\"text-align:right;\"> 0.239 </td>\n   <td style=\"text-align:right;\"> 3.239 </td>\n   <td style=\"text-align:right;\"> 89.305 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.160 </td>\n   <td style=\"text-align:right;\"> 0.642 </td>\n   <td style=\"text-align:right;\"> 0.310 </td>\n   <td style=\"text-align:right;\"> 0.239 </td>\n   <td style=\"text-align:right;\"> 3.126 </td>\n   <td style=\"text-align:right;\"> 91.668 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.165 </td>\n   <td style=\"text-align:right;\"> 0.652 </td>\n   <td style=\"text-align:right;\"> 0.305 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 3.028 </td>\n   <td style=\"text-align:right;\"> 94.054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.170 </td>\n   <td style=\"text-align:right;\"> 0.663 </td>\n   <td style=\"text-align:right;\"> 0.302 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 2.933 </td>\n   <td style=\"text-align:right;\"> 96.457 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.175 </td>\n   <td style=\"text-align:right;\"> 0.673 </td>\n   <td style=\"text-align:right;\"> 0.298 </td>\n   <td style=\"text-align:right;\"> 0.238 </td>\n   <td style=\"text-align:right;\"> 2.845 </td>\n   <td style=\"text-align:right;\"> 98.873 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.180 </td>\n   <td style=\"text-align:right;\"> 0.682 </td>\n   <td style=\"text-align:right;\"> 0.293 </td>\n   <td style=\"text-align:right;\"> 0.237 </td>\n   <td style=\"text-align:right;\"> 2.759 </td>\n   <td style=\"text-align:right;\"> 101.304 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.185 </td>\n   <td style=\"text-align:right;\"> 0.692 </td>\n   <td style=\"text-align:right;\"> 0.289 </td>\n   <td style=\"text-align:right;\"> 0.236 </td>\n   <td style=\"text-align:right;\"> 2.680 </td>\n   <td style=\"text-align:right;\"> 103.745 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.190 </td>\n   <td style=\"text-align:right;\"> 0.702 </td>\n   <td style=\"text-align:right;\"> 0.284 </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 2.600 </td>\n   <td style=\"text-align:right;\"> 106.192 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.195 </td>\n   <td style=\"text-align:right;\"> 0.710 </td>\n   <td style=\"text-align:right;\"> 0.279 </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 2.534 </td>\n   <td style=\"text-align:right;\"> 108.645 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0.200 </td>\n   <td style=\"text-align:right;\"> 0.719 </td>\n   <td style=\"text-align:right;\"> 0.276 </td>\n   <td style=\"text-align:right;\"> 0.235 </td>\n   <td style=\"text-align:right;\"> 2.470 </td>\n   <td style=\"text-align:right;\"> 111.103 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nsimilar switch at 0.075 to a different region of the parameter space. \n\nHere are the plots for rates 0.005-0.10:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_data <- best_subset |>\n  unnest(c(data, pred)) |>\n  mutate(\n    gap = as.factor(gap),\n    rate = round(rate, 3)\n  )\n```\n:::\n\n\n\n::: {.panel-tabset}\n\n## Rate [0.005, 0.025]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate < 0.026))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits 1 (exp1)-1.png){width=768}\n:::\n:::\n\n\n## Rate [0.03, 0.05]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate < 0.051 & rate > 0.029))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits 2 (exp1)-1.png){width=768}\n:::\n:::\n\n\n## Rate [0.055, 0.75]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate < 0.076 & rate > 0.054))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits 3 (exp1)-1.png){width=768}\n:::\n:::\n\n\n## Rate [0.08, 0.10]\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyplot(filter(pred_data, rate > 0.079, rate < 0.101))\n```\n\n::: {.cell-output-display}\n![](par-identifiability_files/figure-html/plot rate fits 4 (exp1)-1.png){width=768}\n:::\n:::\n\n\n:::\n\nso even a rate of 0.07 does not necessarily predict a big interaction\n\n## Summary\n\n- The parameter space is not smooth, but rather jumps between regions when rate is fixed to different values\n- There are ridges in the parameter space where the fits are very similar",
    "supporting": [
      "par-identifiability_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}